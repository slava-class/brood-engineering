[tools]
# Bun for installing/running JS tooling (FactorioTest CLI).
bun = "latest"
# FactorioTest CLI currently shells out to `npx fmtk ...`,
# so Node (and npm/npx) is still required for now.
node = "20"
# Lua formatter.
stylua = "latest"

[tasks.factorio-test]
run = '''
bun run --bun test:factorio -- --factorio-path "$HOME/Library/Application Support/Steam/steamapps/common/Factorio/factorio.app/Contents/MacOS/factorio" -- --disable-audio --cache-sprite-atlas
'''

[tasks.test]
run = "mise run factorio-test"

[tasks.fmt-lua]
run = "stylua control.lua data.lua settings.lua scripts tests"

[tasks.fmt-lua-check]
run = "stylua --check control.lua data.lua settings.lua scripts tests"

[tasks.fmt]
run = "mise run fmt-lua"

[tasks.fmt-check]
run = "mise run fmt-lua-check"

[tasks.docs]
# Wrapper around the local factorio-llm-docs corpus (search/get/open).
# Configure the checkout path via FACTORIO_LLM_DOCS_ROOT if needed.
run = "bash bin/fdocs"

[env]
# In sandboxed environments (e.g. Codex workspace-write), writing to `~/Library/Caches`
# and other home-scoped directories may be blocked. Keep mise state inside the repo.
MISE_CACHE_DIR = ".mise/cache"
